"""Revised tsv parsing code generated by ChatGPT4"""

import pandas as pd
from pathlib import Path

file_path = 'project_repos_from_jos_2024-feb-22.tsv'

# Initialize lists to hold the column data
a_values, b_values, c_values = [], [], []

# Read the file line by line
with open(file_path, 'r') as file:
    for line in file:
        columns = line.strip().split('\t')

        if len(columns) == 3:
            # If there are three columns, append them directly
            a_values.append(columns[0])
            b_values.append(columns[1])
            c_values.append(columns[2])
        elif len(columns) == 1:
            # If there is one column, use the previous 'a' and 'b' values, and append 'c'
            a_values.append(a_values[-1] if a_values else pd.NA)
            b_values.append(b_values[-1] if b_values else pd.NA)
            c_values.append(columns[0])
        else:
            raise ValueError(f"Unexpected number of columns: {len(columns)}")

# Create a DataFrame from the accumulated lists
df = pd.DataFrame({'projectref': a_values, 'nlnetpage': b_values, 'repourl': c_values})

# Print a subset of the resulting rows to visually confirm the expected info is present.
print(df.iloc[0:31])

# Save the dataframe as a CSV file
curr_dir = Path(__file__).parent.parent
path_to_data_folder = str(curr_dir) + '/data'
df.to_csv(path_to_data_folder + '/github_df.csv', index=False)
